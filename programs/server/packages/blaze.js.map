{"version":3,"sources":["meteor://ðŸ’»app/packages/blaze/preamble.js","meteor://ðŸ’»app/packages/blaze/exceptions.js","meteor://ðŸ’»app/packages/blaze/view.js","meteor://ðŸ’»app/packages/blaze/builtins.js","meteor://ðŸ’»app/packages/blaze/lookup.js","meteor://ðŸ’»app/packages/blaze/template.js","meteor://ðŸ’»app/packages/blaze/backcompat.js"],"names":["Blaze","_escape","escape_map","escape_one","c","x","replace","_warn","msg","console","warn","nativeBind","Function","prototype","bind","_bind","func","obj","arguments","length","call","args","Array","i","apply","slice","objA","objB","debugFunc","_throwNextException","_reportException","e","Meteor","_debug","log","stack","message","_wrapCatchingExceptions","f","where","View","name","render","_render","_callbacks","created","rendered","destroyed","isCreated","_isCreatedForExpansion","isRendered","_isAttached","isDestroyed","_isInRender","parentView","_domrange","_hasGeneratedParent","_scopeBindings","renderCount","onViewCreated","cb","push","_onViewRendered","onViewReady","self","fire","Tracker","afterFlush","_withCurrentView","onViewRendered","attached","onAttached","onViewDestroyed","removeViewDestroyedListener","index","lastIndexOf","autorun","_inViewScope","displayName","Error","templateInstanceFunc","Template","_currentTemplateInstanceFunc","viewAutorun","_withTemplateInstanceFunc","comp","stopComputation","stop","onStop","_errorIfShouldntCallSubscribe","subscribe","options","subHandle","connection","firstNode","lastNode","_fireCallbacks","view","which","nonreactive","fireCallbacks","cbs","N","_createView","forExpansion","doFirstRender","initialContent","domrange","_DOMRange","teardownHook","range","element","_DOMBackend","Teardown","onElementTeardown","teardown","_destroyView","_materializeView","_workStack","_intoArray","lastHtmljs","doRender","htmljs","firstRun","_isContentEqual","doMaterialize","rangesAndNodes","_materializeDOM","setMembers","onInvalidate","destroyMembers","undefined","initialContents","_expandView","result","_expand","active","_HTMLJSExpander","HTML","TransformingVisitor","extend","def","visitObject","constructView","visitAttributes","attrs","visitAttribute","value","tag","currentViewIfRendering","currentView","visit","_expandAttributes","_skipNodes","_destroyNode","node","nodeType","tearDownElement","a","b","Raw","oldView","checkRenderContent","content","Visitor","contentAsView","contentAsFunc","__rootViews","parentElement","nextNode","indexOf","splice","attach","insert","renderWithData","data","_TemplateWith","remove","destroy","parentRange","detach","toHTML","toHTMLWithData","_toText","textMode","TEXTMODE","STRING","RCDATA","ATTRIBUTE","toText","getData","elementOrView","theWith","getView","dataVar","get","getElementData","_viewName","viewName","_getCurrentView","_getParentView","_getElementView","v","elem","forElement","_addEventMap","eventMap","thisInHandler","handles","attached_eventMaps","Object","keys","forEach","spec","handler","clauses","split","clause","parts","newEvents","shift","selector","join","_EventSupport","listen","evt","containsElement","currentTarget","handlerThis","handlerArgs","r","h","has","module","link","default","isObject","_calculateCondition","cond","isArray","With","contentFunc","ReactiveVar","set","_isEqualBinding","y","error","_isEqual","_attachBindingsToView","bindings","setBindingValue","then","entries","_ref","binding","Let","If","conditionFunc","elseFunc","_not","conditionVar","__conditionVar","Unless","Each","argFunc","eachView","subviews","initialSubviews","expandedValueDep","Dependency","depend","numItems","inElseMode","stopHandle","argVar","variableName","updateIndices","from","to","members","arg","_variable","_sequence","ObserveSequence","observe","addedAt","id","item","newItemView","changed","removeMember","addMember","removedAt","changedAt","newItem","oldItem","itemView","getMember","movedTo","fromIndex","toIndex","moveMember","Math","min","max","w","wrappedArgFunc","viewToEvaluateArg","originalParentView","wrappedContentFunc","__isTemplateWith","_InOuterTemplateScope","templateView","__childDoesntStartNewLexicalScope","_createBindingsHelper","fn","_len","names","_key","some","_lexicalBindingLookup","concat","_globalHelpers","registerHelper","deregisterHelper","bindIfIsFunction","target","bindDataContext","_OLDSTYLE_HELPER","_getTemplateHelper","template","tmplInstanceFunc","isKnownOldStyleHelper","__helpers","helper","wrapHelper","_NOWARN_OLDSTYLE_HELPERS","templateFunc","_lexicalKeepGoing","__startsNewLexicalScope","_binding$get","_getTemplate","templateInstance","_getGlobalHelper","lookup","_options","lookupTemplate","boundTmplInstance","foundTemplate","test","_parentData","isCalledAsFunction","charAt","height","_functionWrapped","isFunction","isEmpty","renderFunction","HelperMap","__eventMaps","isTemplate","t","onCreated","onRendered","onDestroyed","_getCallbacks","callbacks","templateContentBlock","templateElseBlock","events","m","_templateInstance","TemplateInstance","inst","createdCallbacks","renderedCallbacks","destroyedCallbacks","_allSubsReadyDep","_allSubsReady","_subscriptionHandles","$","findAll","find","subHandles","lastParam","lastParamOptionsPattern","onReady","Match","Optional","onError","Any","pop","oldStopped","subscriptionId","subscriptionsReady","values","every","handle","ready","helpers","dict","k","canUseGetters","defineProperty","currentTemplateInstanceFunc","oldTmplInstanceFunc","eventMap2","event","instance","currentData","parentData","UI","Handlebars","SafeString","string","toString"],"mappings":"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","file":"/packages/blaze.js","sourcesContent":["/**\n * @namespace Blaze\n * @summary The namespace for all Blaze-related methods and classes.\n */\nBlaze = {};\n\n// Utility to HTML-escape a string.  Included for legacy reasons.\n// TODO: Should be replaced with _.escape once underscore is upgraded to a newer\n//       version which escapes ` (backtick) as well. Underscore 1.5.2 does not.\nBlaze._escape = (function() {\n  var escape_map = {\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': \"&quot;\",\n    \"'\": \"&#x27;\",\n    \"/\": \"&#x2F;\",\n    \"`\": \"&#x60;\", /* IE allows backtick-delimited attributes?? */\n    \"&\": \"&amp;\"\n  };\n  var escape_one = function(c) {\n    return escape_map[c];\n  };\n\n  return function (x) {\n    return x.replace(/[&<>\"'`]/g, escape_one);\n  };\n})();\n\nBlaze._warn = function (msg) {\n  msg = 'Warning: ' + msg;\n\n  if ((typeof console !== 'undefined') && console.warn) {\n    console.warn(msg);\n  }\n};\n\nvar nativeBind = Function.prototype.bind;\n\n// An implementation of _.bind which allows better optimization.\n// See: https://github.com/petkaantonov/bluebird/wiki/Optimization-killers#3-managing-arguments\nif (nativeBind) {\n  Blaze._bind = function (func, obj) {\n    if (arguments.length === 2) {\n      return nativeBind.call(func, obj);\n    }\n\n    // Copy the arguments so this function can be optimized.\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    return nativeBind.apply(func, args.slice(1));\n  };\n}\nelse {\n  // A slower but backwards compatible version.\n  Blaze._bind = function(objA, objB) {\n    objA.bind(objB);\n  };\n}\n","var debugFunc;\n\n// We call into user code in many places, and it's nice to catch exceptions\n// propagated from user code immediately so that the whole system doesn't just\n// break.  Catching exceptions is easy; reporting them is hard.  This helper\n// reports exceptions.\n//\n// Usage:\n//\n// ```\n// try {\n//   // ... someStuff ...\n// } catch (e) {\n//   reportUIException(e);\n// }\n// ```\n//\n// An optional second argument overrides the default message.\n\n// Set this to `true` to cause `reportException` to throw\n// the next exception rather than reporting it.  This is\n// useful in unit tests that test error messages.\nBlaze._throwNextException = false;\n\nBlaze._reportException = function (e, msg) {\n  if (Blaze._throwNextException) {\n    Blaze._throwNextException = false;\n    throw e;\n  }\n\n  if (! debugFunc)\n    // adapted from Tracker\n    debugFunc = function () {\n      return (typeof Meteor !== \"undefined\" ? Meteor._debug :\n              ((typeof console !== \"undefined\") && console.log ? console.log :\n               function () {}));\n    };\n\n  // In Chrome, `e.stack` is a multiline string that starts with the message\n  // and contains a stack trace.  Furthermore, `console.log` makes it clickable.\n  // `console.log` supplies the space between the two arguments.\n  debugFunc()(msg || 'Exception caught in template:', e.stack || e.message || e);\n};\n\nBlaze._wrapCatchingExceptions = function (f, where) {\n  if (typeof f !== 'function')\n    return f;\n\n  return function () {\n    try {\n      return f.apply(this, arguments);\n    } catch (e) {\n      Blaze._reportException(e, 'Exception in ' + where + ':');\n    }\n  };\n};\n","/// [new] Blaze.View([name], renderMethod)\n///\n/// Blaze.View is the building block of reactive DOM.  Views have\n/// the following features:\n///\n/// * lifecycle callbacks - Views are created, rendered, and destroyed,\n///   and callbacks can be registered to fire when these things happen.\n///\n/// * parent pointer - A View points to its parentView, which is the\n///   View that caused it to be rendered.  These pointers form a\n///   hierarchy or tree of Views.\n///\n/// * render() method - A View's render() method specifies the DOM\n///   (or HTML) content of the View.  If the method establishes\n///   reactive dependencies, it may be re-run.\n///\n/// * a DOMRange - If a View is rendered to DOM, its position and\n///   extent in the DOM are tracked using a DOMRange object.\n///\n/// When a View is constructed by calling Blaze.View, the View is\n/// not yet considered \"created.\"  It doesn't have a parentView yet,\n/// and no logic has been run to initialize the View.  All real\n/// work is deferred until at least creation time, when the onViewCreated\n/// callbacks are fired, which happens when the View is \"used\" in\n/// some way that requires it to be rendered.\n///\n/// ...more lifecycle stuff\n///\n/// `name` is an optional string tag identifying the View.  The only\n/// time it's used is when looking in the View tree for a View of a\n/// particular name; for example, data contexts are stored on Views\n/// of name \"with\".  Names are also useful when debugging, so in\n/// general it's good for functions that create Views to set the name.\n/// Views associated with templates have names of the form \"Template.foo\".\n\n/**\n * A binding is either `undefined` (pending), `{ error }` (rejected), or\n * `{ value }` (resolved). Synchronous values are immediately resolved (i.e.,\n * `{ value }` is used). The other states are reserved for asynchronous bindings\n * (i.e., values wrapped with `Promise`s).\n * @typedef {{ error: unknown } | { value: unknown } | undefined} Binding\n */\n\n/**\n * @class\n * @summary Constructor for a View, which represents a reactive region of DOM.\n * @locus Client\n * @param {String} [name] Optional.  A name for this type of View.  See [`view.name`](#view_name).\n * @param {Function} renderFunction A function that returns [*renderable content*](#Renderable-Content).  In this function, `this` is bound to the View.\n */\nBlaze.View = function (name, render) {\n  if (! (this instanceof Blaze.View))\n    // called without `new`\n    return new Blaze.View(name, render);\n\n  if (typeof name === 'function') {\n    // omitted \"name\" argument\n    render = name;\n    name = '';\n  }\n  this.name = name;\n  this._render = render;\n\n  this._callbacks = {\n    created: null,\n    rendered: null,\n    destroyed: null\n  };\n\n  // Setting all properties here is good for readability,\n  // and also may help Chrome optimize the code by keeping\n  // the View object from changing shape too much.\n  this.isCreated = false;\n  this._isCreatedForExpansion = false;\n  this.isRendered = false;\n  this._isAttached = false;\n  this.isDestroyed = false;\n  this._isInRender = false;\n  this.parentView = null;\n  this._domrange = null;\n  // This flag is normally set to false except for the cases when view's parent\n  // was generated as part of expanding some syntactic sugar expressions or\n  // methods.\n  // Ex.: Blaze.renderWithData is an equivalent to creating a view with regular\n  // Blaze.render and wrapping it into {{#with data}}{{/with}} view. Since the\n  // users don't know anything about these generated parent views, Blaze needs\n  // this information to be available on views to make smarter decisions. For\n  // example: removing the generated parent view with the view on Blaze.remove.\n  this._hasGeneratedParent = false;\n  // Bindings accessible to children views (via view.lookup('name')) within the\n  // closest template view.\n  /** @type {Record<string, ReactiveVar<Binding>>} */\n  this._scopeBindings = {};\n\n  this.renderCount = 0;\n};\n\nBlaze.View.prototype._render = function () { return null; };\n\nBlaze.View.prototype.onViewCreated = function (cb) {\n  this._callbacks.created = this._callbacks.created || [];\n  this._callbacks.created.push(cb);\n};\n\nBlaze.View.prototype._onViewRendered = function (cb) {\n  this._callbacks.rendered = this._callbacks.rendered || [];\n  this._callbacks.rendered.push(cb);\n};\n\nBlaze.View.prototype.onViewReady = function (cb) {\n  var self = this;\n  var fire = function () {\n    Tracker.afterFlush(function () {\n      if (! self.isDestroyed) {\n        Blaze._withCurrentView(self, function () {\n          cb.call(self);\n        });\n      }\n    });\n  };\n  self._onViewRendered(function onViewRendered() {\n    if (self.isDestroyed)\n      return;\n    if (! self._domrange.attached)\n      self._domrange.onAttached(fire);\n    else\n      fire();\n  });\n};\n\nBlaze.View.prototype.onViewDestroyed = function (cb) {\n  this._callbacks.destroyed = this._callbacks.destroyed || [];\n  this._callbacks.destroyed.push(cb);\n};\nBlaze.View.prototype.removeViewDestroyedListener = function (cb) {\n  var destroyed = this._callbacks.destroyed;\n  if (! destroyed)\n    return;\n  var index = destroyed.lastIndexOf(cb);\n  if (index !== -1) {\n    // XXX You'd think the right thing to do would be splice, but _fireCallbacks\n    // gets sad if you remove callbacks while iterating over the list.  Should\n    // change this to use callback-hook or EventEmitter or something else that\n    // properly supports removal.\n    destroyed[index] = null;\n  }\n};\n\n/// View#autorun(func)\n///\n/// Sets up a Tracker autorun that is \"scoped\" to this View in two\n/// important ways: 1) Blaze.currentView is automatically set\n/// on every re-run, and 2) the autorun is stopped when the\n/// View is destroyed.  As with Tracker.autorun, the first run of\n/// the function is immediate, and a Computation object that can\n/// be used to stop the autorun is returned.\n///\n/// View#autorun is meant to be called from View callbacks like\n/// onViewCreated, or from outside the rendering process.  It may not\n/// be called before the onViewCreated callbacks are fired (too early),\n/// or from a render() method (too confusing).\n///\n/// Typically, autoruns that update the state\n/// of the View (as in Blaze.With) should be started from an onViewCreated\n/// callback.  Autoruns that update the DOM should be started\n/// from either onViewCreated (guarded against the absence of\n/// view._domrange), or onViewReady.\nBlaze.View.prototype.autorun = function (f, _inViewScope, displayName) {\n  var self = this;\n\n  // The restrictions on when View#autorun can be called are in order\n  // to avoid bad patterns, like creating a Blaze.View and immediately\n  // calling autorun on it.  A freshly created View is not ready to\n  // have logic run on it; it doesn't have a parentView, for example.\n  // It's when the View is materialized or expanded that the onViewCreated\n  // handlers are fired and the View starts up.\n  //\n  // Letting the render() method call `this.autorun()` is problematic\n  // because of re-render.  The best we can do is to stop the old\n  // autorun and start a new one for each render, but that's a pattern\n  // we try to avoid internally because it leads to helpers being\n  // called extra times, in the case where the autorun causes the\n  // view to re-render (and thus the autorun to be torn down and a\n  // new one established).\n  //\n  // We could lift these restrictions in various ways.  One interesting\n  // idea is to allow you to call `view.autorun` after instantiating\n  // `view`, and automatically wrap it in `view.onViewCreated`, deferring\n  // the autorun so that it starts at an appropriate time.  However,\n  // then we can't return the Computation object to the caller, because\n  // it doesn't exist yet.\n  if (! self.isCreated) {\n    throw new Error(\"View#autorun must be called from the created callback at the earliest\");\n  }\n  if (this._isInRender) {\n    throw new Error(\"Can't call View#autorun from inside render(); try calling it from the created or rendered callback\");\n  }\n\n  var templateInstanceFunc = Blaze.Template._currentTemplateInstanceFunc;\n\n  var func = function viewAutorun(c) {\n    return Blaze._withCurrentView(_inViewScope || self, function () {\n      return Blaze.Template._withTemplateInstanceFunc(\n        templateInstanceFunc, function () {\n          return f.call(self, c);\n        });\n    });\n  };\n\n  // Give the autorun function a better name for debugging and profiling.\n  // The `displayName` property is not part of the spec but browsers like Chrome\n  // and Firefox prefer it in debuggers over the name function was declared by.\n  func.displayName =\n    (self.name || 'anonymous') + ':' + (displayName || 'anonymous');\n  var comp = Tracker.autorun(func);\n\n  var stopComputation = function () { comp.stop(); };\n  self.onViewDestroyed(stopComputation);\n  comp.onStop(function () {\n    self.removeViewDestroyedListener(stopComputation);\n  });\n\n  return comp;\n};\n\nBlaze.View.prototype._errorIfShouldntCallSubscribe = function () {\n  var self = this;\n\n  if (! self.isCreated) {\n    throw new Error(\"View#subscribe must be called from the created callback at the earliest\");\n  }\n  if (self._isInRender) {\n    throw new Error(\"Can't call View#subscribe from inside render(); try calling it from the created or rendered callback\");\n  }\n  if (self.isDestroyed) {\n    throw new Error(\"Can't call View#subscribe from inside the destroyed callback, try calling it inside created or rendered.\");\n  }\n};\n\n/**\n * Just like Blaze.View#autorun, but with Meteor.subscribe instead of\n * Tracker.autorun. Stop the subscription when the view is destroyed.\n * @return {SubscriptionHandle} A handle to the subscription so that you can\n * see if it is ready, or stop it manually\n */\nBlaze.View.prototype.subscribe = function (args, options) {\n  var self = this;\n  options = options || {};\n\n  self._errorIfShouldntCallSubscribe();\n\n  var subHandle;\n  if (options.connection) {\n    subHandle = options.connection.subscribe.apply(options.connection, args);\n  } else {\n    subHandle = Meteor.subscribe.apply(Meteor, args);\n  }\n\n  self.onViewDestroyed(function () {\n    subHandle.stop();\n  });\n\n  return subHandle;\n};\n\nBlaze.View.prototype.firstNode = function () {\n  if (! this._isAttached)\n    throw new Error(\"View must be attached before accessing its DOM\");\n\n  return this._domrange.firstNode();\n};\n\nBlaze.View.prototype.lastNode = function () {\n  if (! this._isAttached)\n    throw new Error(\"View must be attached before accessing its DOM\");\n\n  return this._domrange.lastNode();\n};\n\nBlaze._fireCallbacks = function (view, which) {\n  Blaze._withCurrentView(view, function () {\n    Tracker.nonreactive(function fireCallbacks() {\n      var cbs = view._callbacks[which];\n      for (var i = 0, N = (cbs && cbs.length); i < N; i++)\n        cbs[i] && cbs[i].call(view);\n    });\n  });\n};\n\nBlaze._createView = function (view, parentView, forExpansion) {\n  if (view.isCreated)\n    throw new Error(\"Can't render the same View twice\");\n\n  view.parentView = (parentView || null);\n  view.isCreated = true;\n  if (forExpansion)\n    view._isCreatedForExpansion = true;\n\n  Blaze._fireCallbacks(view, 'created');\n};\n\nvar doFirstRender = function (view, initialContent) {\n  var domrange = new Blaze._DOMRange(initialContent);\n  view._domrange = domrange;\n  domrange.view = view;\n  view.isRendered = true;\n  Blaze._fireCallbacks(view, 'rendered');\n\n  var teardownHook = null;\n\n  domrange.onAttached(function attached(range, element) {\n    view._isAttached = true;\n\n    teardownHook = Blaze._DOMBackend.Teardown.onElementTeardown(\n      element, function teardown() {\n        Blaze._destroyView(view, true /* _skipNodes */);\n      });\n  });\n\n  // tear down the teardown hook\n  view.onViewDestroyed(function () {\n    teardownHook && teardownHook.stop();\n    teardownHook = null;\n  });\n\n  return domrange;\n};\n\n// Take an uncreated View `view` and create and render it to DOM,\n// setting up the autorun that updates the View.  Returns a new\n// DOMRange, which has been associated with the View.\n//\n// The private arguments `_workStack` and `_intoArray` are passed in\n// by Blaze._materializeDOM and are only present for recursive calls\n// (when there is some other _materializeView on the stack).  If\n// provided, then we avoid the mutual recursion of calling back into\n// Blaze._materializeDOM so that deep View hierarchies don't blow the\n// stack.  Instead, we push tasks onto workStack for the initial\n// rendering and subsequent setup of the View, and they are done after\n// we return.  When there is a _workStack, we do not return the new\n// DOMRange, but instead push it into _intoArray from a _workStack\n// task.\nBlaze._materializeView = function (view, parentView, _workStack, _intoArray) {\n  Blaze._createView(view, parentView);\n\n  var domrange;\n  var lastHtmljs;\n  // We don't expect to be called in a Computation, but just in case,\n  // wrap in Tracker.nonreactive.\n  Tracker.nonreactive(function () {\n    view.autorun(function doRender(c) {\n      // `view.autorun` sets the current view.\n      view.renderCount++;\n      view._isInRender = true;\n      // Any dependencies that should invalidate this Computation come\n      // from this line:\n      var htmljs = view._render();\n      view._isInRender = false;\n\n      if (! c.firstRun && ! Blaze._isContentEqual(lastHtmljs, htmljs)) {\n        Tracker.nonreactive(function doMaterialize() {\n          // re-render\n          var rangesAndNodes = Blaze._materializeDOM(htmljs, [], view);\n          domrange.setMembers(rangesAndNodes);\n          Blaze._fireCallbacks(view, 'rendered');\n        });\n      }\n      lastHtmljs = htmljs;\n\n      // Causes any nested views to stop immediately, not when we call\n      // `setMembers` the next time around the autorun.  Otherwise,\n      // helpers in the DOM tree to be replaced might be scheduled\n      // to re-run before we have a chance to stop them.\n      Tracker.onInvalidate(function () {\n        if (domrange) {\n          domrange.destroyMembers();\n        }\n      });\n    }, undefined, 'materialize');\n\n    // first render.  lastHtmljs is the first htmljs.\n    var initialContents;\n    if (! _workStack) {\n      initialContents = Blaze._materializeDOM(lastHtmljs, [], view);\n      domrange = doFirstRender(view, initialContents);\n      initialContents = null; // help GC because we close over this scope a lot\n    } else {\n      // We're being called from Blaze._materializeDOM, so to avoid\n      // recursion and save stack space, provide a description of the\n      // work to be done instead of doing it.  Tasks pushed onto\n      // _workStack will be done in LIFO order after we return.\n      // The work will still be done within a Tracker.nonreactive,\n      // because it will be done by some call to Blaze._materializeDOM\n      // (which is always called in a Tracker.nonreactive).\n      initialContents = [];\n      // push this function first so that it happens last\n      _workStack.push(function () {\n        domrange = doFirstRender(view, initialContents);\n        initialContents = null; // help GC because of all the closures here\n        _intoArray.push(domrange);\n      });\n      // now push the task that calculates initialContents\n      _workStack.push(Blaze._bind(Blaze._materializeDOM, null,\n                             lastHtmljs, initialContents, view, _workStack));\n    }\n  });\n\n  if (! _workStack) {\n    return domrange;\n  } else {\n    return null;\n  }\n};\n\n// Expands a View to HTMLjs, calling `render` recursively on all\n// Views and evaluating any dynamic attributes.  Calls the `created`\n// callback, but not the `materialized` or `rendered` callbacks.\n// Destroys the view immediately, unless called in a Tracker Computation,\n// in which case the view will be destroyed when the Computation is\n// invalidated.  If called in a Tracker Computation, the result is a\n// reactive string; that is, the Computation will be invalidated\n// if any changes are made to the view or subviews that might affect\n// the HTML.\nBlaze._expandView = function (view, parentView) {\n  Blaze._createView(view, parentView, true /*forExpansion*/);\n\n  view._isInRender = true;\n  var htmljs = Blaze._withCurrentView(view, function () {\n    return view._render();\n  });\n  view._isInRender = false;\n\n  var result = Blaze._expand(htmljs, view);\n\n  if (Tracker.active) {\n    Tracker.onInvalidate(function () {\n      Blaze._destroyView(view);\n    });\n  } else {\n    Blaze._destroyView(view);\n  }\n\n  return result;\n};\n\n// Options: `parentView`\nBlaze._HTMLJSExpander = HTML.TransformingVisitor.extend();\nBlaze._HTMLJSExpander.def({\n  visitObject: function (x) {\n    if (x instanceof Blaze.Template)\n      x = x.constructView();\n    if (x instanceof Blaze.View)\n      return Blaze._expandView(x, this.parentView);\n\n    // this will throw an error; other objects are not allowed!\n    return HTML.TransformingVisitor.prototype.visitObject.call(this, x);\n  },\n  visitAttributes: function (attrs) {\n    // expand dynamic attributes\n    if (typeof attrs === 'function')\n      attrs = Blaze._withCurrentView(this.parentView, attrs);\n\n    // call super (e.g. for case where `attrs` is an array)\n    return HTML.TransformingVisitor.prototype.visitAttributes.call(this, attrs);\n  },\n  visitAttribute: function (name, value, tag) {\n    // expand attribute values that are functions.  Any attribute value\n    // that contains Views must be wrapped in a function.\n    if (typeof value === 'function')\n      value = Blaze._withCurrentView(this.parentView, value);\n\n    return HTML.TransformingVisitor.prototype.visitAttribute.call(\n      this, name, value, tag);\n  }\n});\n\n// Return Blaze.currentView, but only if it is being rendered\n// (i.e. we are in its render() method).\nvar currentViewIfRendering = function () {\n  var view = Blaze.currentView;\n  return (view && view._isInRender) ? view : null;\n};\n\nBlaze._expand = function (htmljs, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return (new Blaze._HTMLJSExpander(\n    {parentView: parentView})).visit(htmljs);\n};\n\nBlaze._expandAttributes = function (attrs, parentView) {\n  parentView = parentView || currentViewIfRendering();\n  return (new Blaze._HTMLJSExpander(\n    {parentView: parentView})).visitAttributes(attrs);\n};\n\nBlaze._destroyView = function (view, _skipNodes) {\n  if (view.isDestroyed)\n    return;\n  view.isDestroyed = true;\n\n\n  // Destroy views and elements recursively.  If _skipNodes,\n  // only recurse up to views, not elements, for the case where\n  // the backend (jQuery) is recursing over the elements already.\n\n  if (view._domrange) view._domrange.destroyMembers(_skipNodes);\n\n  // XXX: fire callbacks after potential members are destroyed\n  // otherwise it's tracker.flush will cause the above line will\n  // not be called and their views won't be destroyed\n  // Involved issues: DOMRange \"Must be attached\" error, mem leak\n  \n  Blaze._fireCallbacks(view, 'destroyed');\n};\n\nBlaze._destroyNode = function (node) {\n  if (node.nodeType === 1)\n    Blaze._DOMBackend.Teardown.tearDownElement(node);\n};\n\n// Are the HTMLjs entities `a` and `b` the same?  We could be\n// more elaborate here but the point is to catch the most basic\n// cases.\nBlaze._isContentEqual = function (a, b) {\n  if (a instanceof HTML.Raw) {\n    return (b instanceof HTML.Raw) && (a.value === b.value);\n  } else if (a == null) {\n    return (b == null);\n  } else {\n    return (a === b) &&\n      ((typeof a === 'number') || (typeof a === 'boolean') ||\n       (typeof a === 'string'));\n  }\n};\n\n/**\n * @summary The View corresponding to the current template helper, event handler, callback, or autorun.  If there isn't one, `null`.\n * @locus Client\n * @type {Blaze.View}\n */\nBlaze.currentView = null;\n\n/**\n * @template T\n * @param {Blaze.View} view\n * @param {() => T} func\n * @returns {T}\n */\nBlaze._withCurrentView = function (view, func) {\n  var oldView = Blaze.currentView;\n  try {\n    Blaze.currentView = view;\n    return func();\n  } finally {\n    Blaze.currentView = oldView;\n  }\n};\n\n// Blaze.render publicly takes a View or a Template.\n// Privately, it takes any HTMLJS (extended with Views and Templates)\n// except null or undefined, or a function that returns any extended\n// HTMLJS.\nvar checkRenderContent = function (content) {\n  if (content === null)\n    throw new Error(\"Can't render null\");\n  if (typeof content === 'undefined')\n    throw new Error(\"Can't render undefined\");\n\n  if ((content instanceof Blaze.View) ||\n      (content instanceof Blaze.Template) ||\n      (typeof content === 'function'))\n    return;\n\n  try {\n    // Throw if content doesn't look like HTMLJS at the top level\n    // (i.e. verify that this is an HTML.Tag, or an array,\n    // or a primitive, etc.)\n    (new HTML.Visitor).visit(content);\n  } catch (e) {\n    // Make error message suitable for public API\n    throw new Error(\"Expected Template or View\");\n  }\n};\n\n// For Blaze.render and Blaze.toHTML, take content and\n// wrap it in a View, unless it's a single View or\n// Template already.\nvar contentAsView = function (content) {\n  checkRenderContent(content);\n\n  if (content instanceof Blaze.Template) {\n    return content.constructView();\n  } else if (content instanceof Blaze.View) {\n    return content;\n  } else {\n    var func = content;\n    if (typeof func !== 'function') {\n      func = function () {\n        return content;\n      };\n    }\n    return Blaze.View('render', func);\n  }\n};\n\n// For Blaze.renderWithData and Blaze.toHTMLWithData, wrap content\n// in a function, if necessary, so it can be a content arg to\n// a Blaze.With.\nvar contentAsFunc = function (content) {\n  checkRenderContent(content);\n\n  if (typeof content !== 'function') {\n    return function () {\n      return content;\n    };\n  } else {\n    return content;\n  }\n};\n\nBlaze.__rootViews = [];\n\n/**\n * @summary Renders a template or View to DOM nodes and inserts it into the DOM, returning a rendered [View](#Blaze-View) which can be passed to [`Blaze.remove`](#Blaze-remove).\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object to render.  If a template, a View object is [constructed](#template_constructview).  If a View, it must be an unrendered View, which becomes a rendered View and is returned.\n * @param {DOMNode} parentNode The node that will be the parent of the rendered template.  It must be an Element node.\n * @param {DOMNode} [nextNode] Optional. If provided, must be a child of <em>parentNode</em>; the template will be inserted before this node. If not provided, the template will be inserted as the last child of parentNode.\n * @param {Blaze.View} [parentView] Optional. If provided, it will be set as the rendered View's [`parentView`](#view_parentview).\n */\nBlaze.render = function (content, parentElement, nextNode, parentView) {\n  if (! parentElement) {\n    Blaze._warn(\"Blaze.render without a parent element is deprecated. \" +\n                \"You must specify where to insert the rendered content.\");\n  }\n\n  if (nextNode instanceof Blaze.View) {\n    // handle omitted nextNode\n    parentView = nextNode;\n    nextNode = null;\n  }\n\n  // parentElement must be a DOM node. in particular, can't be the\n  // result of a call to `$`. Can't check if `parentElement instanceof\n  // Node` since 'Node' is undefined in IE8.\n  if (parentElement && typeof parentElement.nodeType !== 'number')\n    throw new Error(\"'parentElement' must be a DOM node\");\n  if (nextNode && typeof nextNode.nodeType !== 'number') // 'nextNode' is optional\n    throw new Error(\"'nextNode' must be a DOM node\");\n\n  parentView = parentView || currentViewIfRendering();\n\n  var view = contentAsView(content);\n\n  // TODO: this is only needed in development\n  if (!parentView) {\n    view.onViewCreated(function () {\n      Blaze.__rootViews.push(view);\n    });\n\n    view.onViewDestroyed(function () {\n      var index = Blaze.__rootViews.indexOf(view);\n      if (index > -1) {\n        Blaze.__rootViews.splice(index, 1);\n      }\n    });\n  }\n\n  Blaze._materializeView(view, parentView);\n  if (parentElement) {\n    view._domrange.attach(parentElement, nextNode);\n  }\n\n  return view;\n};\n\nBlaze.insert = function (view, parentElement, nextNode) {\n  Blaze._warn(\"Blaze.insert has been deprecated.  Specify where to insert the \" +\n              \"rendered content in the call to Blaze.render.\");\n\n  if (! (view && (view._domrange instanceof Blaze._DOMRange)))\n    throw new Error(\"Expected template rendered with Blaze.render\");\n\n  view._domrange.attach(parentElement, nextNode);\n};\n\n/**\n * @summary Renders a template or View to DOM nodes with a data context.  Otherwise identical to `Blaze.render`.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object to render.\n * @param {Object|Function} data The data context to use, or a function returning a data context.  If a function is provided, it will be reactively re-run.\n * @param {DOMNode} parentNode The node that will be the parent of the rendered template.  It must be an Element node.\n * @param {DOMNode} [nextNode] Optional. If provided, must be a child of <em>parentNode</em>; the template will be inserted before this node. If not provided, the template will be inserted as the last child of parentNode.\n * @param {Blaze.View} [parentView] Optional. If provided, it will be set as the rendered View's [`parentView`](#view_parentview).\n */\nBlaze.renderWithData = function (content, data, parentElement, nextNode, parentView) {\n  // We defer the handling of optional arguments to Blaze.render.  At this point,\n  // `nextNode` may actually be `parentView`.\n  return Blaze.render(Blaze._TemplateWith(data, contentAsFunc(content)),\n                          parentElement, nextNode, parentView);\n};\n\n/**\n * @summary Removes a rendered View from the DOM, stopping all reactive updates and event listeners on it. Also destroys the Blaze.Template instance associated with the view.\n * @locus Client\n * @param {Blaze.View} renderedView The return value from `Blaze.render` or `Blaze.renderWithData`, or the `view` property of a Blaze.Template instance. Calling `Blaze.remove(Template.instance().view)` from within a template event handler will destroy the view as well as that template and trigger the template's `onDestroyed` handlers.\n */\nBlaze.remove = function (view) {\n  if (! (view && (view._domrange instanceof Blaze._DOMRange)))\n    throw new Error(\"Expected template rendered with Blaze.render\");\n\n  while (view) {\n    if (! view.isDestroyed) {\n      var range = view._domrange;\n      range.destroy();\n\n      if (range.attached && ! range.parentRange) {\n        range.detach();\n      }\n    }\n\n    view = view._hasGeneratedParent && view.parentView;\n  }\n};\n\n/**\n * @summary Renders a template or View to a string of HTML.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object from which to generate HTML.\n */\nBlaze.toHTML = function (content, parentView) {\n  parentView = parentView || currentViewIfRendering();\n\n  return HTML.toHTML(Blaze._expandView(contentAsView(content), parentView));\n};\n\n/**\n * @summary Renders a template or View to HTML with a data context.  Otherwise identical to `Blaze.toHTML`.\n * @locus Client\n * @param {Template|Blaze.View} templateOrView The template (e.g. `Template.myTemplate`) or View object from which to generate HTML.\n * @param {Object|Function} data The data context to use, or a function returning a data context.\n */\nBlaze.toHTMLWithData = function (content, data, parentView) {\n  parentView = parentView || currentViewIfRendering();\n\n  return HTML.toHTML(Blaze._expandView(Blaze._TemplateWith(\n    data, contentAsFunc(content)), parentView));\n};\n\nBlaze._toText = function (htmljs, parentView, textMode) {\n  if (typeof htmljs === 'function')\n    throw new Error(\"Blaze._toText doesn't take a function, just HTMLjs\");\n\n  if ((parentView != null) && ! (parentView instanceof Blaze.View)) {\n    // omitted parentView argument\n    textMode = parentView;\n    parentView = null;\n  }\n  parentView = parentView || currentViewIfRendering();\n\n  if (! textMode)\n    throw new Error(\"textMode required\");\n  if (! (textMode === HTML.TEXTMODE.STRING ||\n         textMode === HTML.TEXTMODE.RCDATA ||\n         textMode === HTML.TEXTMODE.ATTRIBUTE))\n    throw new Error(\"Unknown textMode: \" + textMode);\n\n  return HTML.toText(Blaze._expand(htmljs, parentView), textMode);\n};\n\n/**\n * @summary Returns the current data context, or the data context that was used when rendering a particular DOM element or View from a Meteor template.\n * @locus Client\n * @param {DOMElement|Blaze.View} [elementOrView] Optional.  An element that was rendered by a Meteor, or a View.\n */\nBlaze.getData = function (elementOrView) {\n  var theWith;\n\n  if (! elementOrView) {\n    theWith = Blaze.getView('with');\n  } else if (elementOrView instanceof Blaze.View) {\n    var view = elementOrView;\n    theWith = (view.name === 'with' ? view :\n               Blaze.getView(view, 'with'));\n  } else if (typeof elementOrView.nodeType === 'number') {\n    if (elementOrView.nodeType !== 1)\n      throw new Error(\"Expected DOM element\");\n    theWith = Blaze.getView(elementOrView, 'with');\n  } else {\n    throw new Error(\"Expected DOM element or View\");\n  }\n\n  return theWith ? theWith.dataVar.get() : null;\n};\n\n// For back-compat\nBlaze.getElementData = function (element) {\n  Blaze._warn(\"Blaze.getElementData has been deprecated.  Use \" +\n              \"Blaze.getData(element) instead.\");\n\n  if (element.nodeType !== 1)\n    throw new Error(\"Expected DOM element\");\n\n  return Blaze.getData(element);\n};\n\n// Both arguments are optional.\n\n/**\n * @summary Gets either the current View, or the View enclosing the given DOM element.\n * @locus Client\n * @param {DOMElement} [element] Optional.  If specified, the View enclosing `element` is returned.\n */\nBlaze.getView = function (elementOrView, _viewName) {\n  var viewName = _viewName;\n\n  if ((typeof elementOrView) === 'string') {\n    // omitted elementOrView; viewName present\n    viewName = elementOrView;\n    elementOrView = null;\n  }\n\n  // We could eventually shorten the code by folding the logic\n  // from the other methods into this method.\n  if (! elementOrView) {\n    return Blaze._getCurrentView(viewName);\n  } else if (elementOrView instanceof Blaze.View) {\n    return Blaze._getParentView(elementOrView, viewName);\n  } else if (typeof elementOrView.nodeType === 'number') {\n    return Blaze._getElementView(elementOrView, viewName);\n  } else {\n    throw new Error(\"Expected DOM element or View\");\n  }\n};\n\n// Gets the current view or its nearest ancestor of name\n// `name`.\nBlaze._getCurrentView = function (name) {\n  var view = Blaze.currentView;\n  // Better to fail in cases where it doesn't make sense\n  // to use Blaze._getCurrentView().  There will be a current\n  // view anywhere it does.  You can check Blaze.currentView\n  // if you want to know whether there is one or not.\n  if (! view)\n    throw new Error(\"There is no current view\");\n\n  if (name) {\n    while (view && view.name !== name)\n      view = view.parentView;\n    return view || null;\n  } else {\n    // Blaze._getCurrentView() with no arguments just returns\n    // Blaze.currentView.\n    return view;\n  }\n};\n\nBlaze._getParentView = function (view, name) {\n  var v = view.parentView;\n\n  if (name) {\n    while (v && v.name !== name)\n      v = v.parentView;\n  }\n\n  return v || null;\n};\n\nBlaze._getElementView = function (elem, name) {\n  var range = Blaze._DOMRange.forElement(elem);\n  var view = null;\n  while (range && ! view) {\n    view = (range.view || null);\n    if (! view) {\n      if (range.parentRange)\n        range = range.parentRange;\n      else\n        range = Blaze._DOMRange.forElement(range.parentElement);\n    }\n  }\n\n  if (name) {\n    while (view && view.name !== name)\n      view = view.parentView;\n    return view || null;\n  } else {\n    return view;\n  }\n};\n\nBlaze._addEventMap = function (view, eventMap, thisInHandler) {\n  thisInHandler = (thisInHandler || null);\n  var handles = [];\n\n  if (! view._domrange)\n    throw new Error(\"View must have a DOMRange\");\n\n  view._domrange.onAttached(function attached_eventMaps(range, element) {\n    Object.keys(eventMap).forEach(function (spec) {\n      let handler = eventMap[spec];\n      var clauses = spec.split(/,\\s+/);\n      // iterate over clauses of spec, e.g. ['click .foo', 'click .bar']\n      clauses.forEach(function (clause) {\n        var parts = clause.split(/\\s+/);\n        if (parts.length === 0)\n          return;\n\n        var newEvents = parts.shift();\n        var selector = parts.join(' ');\n        handles.push(Blaze._EventSupport.listen(\n          element, newEvents, selector,\n          function (evt) {\n            if (! range.containsElement(evt.currentTarget, selector, newEvents))\n              return null;\n            var handlerThis = thisInHandler || this;\n            var handlerArgs = arguments;\n            return Blaze._withCurrentView(view, function () {\n              return handler.apply(handlerThis, handlerArgs);\n            });\n          },\n          range, function (r) {\n            return r.parentRange;\n          }));\n      });\n    });\n  });\n\n  view.onViewDestroyed(function () {\n    handles.forEach(function (h) {\n      h.stop();\n    });\n    handles.length = 0;\n  });\n};\n","import has from 'lodash.has';\nimport isObject from 'lodash.isobject';\n\nBlaze._calculateCondition = function (cond) {\n  if (HTML.isArray(cond) && cond.length === 0)\n    cond = false;\n  return !! cond;\n};\n\n/**\n * @summary Constructs a View that renders content with a data context.\n * @locus Client\n * @param {Object|Function} data An object to use as the data context, or a function returning such an object.  If a\n *   function is provided, it will be reactively re-run.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n */\nBlaze.With = function (data, contentFunc) {\n  var view = Blaze.View('with', contentFunc);\n\n  view.dataVar = new ReactiveVar;\n\n  view.onViewCreated(function () {\n    if (typeof data === 'function') {\n      // `data` is a reactive function\n      view.autorun(function () {\n        view.dataVar.set(data());\n      }, view.parentView, 'setData');\n    } else {\n      view.dataVar.set(data);\n    }\n  });\n\n  return view;\n};\n\n\n/**\n * @summary Shallow compare of two bindings.\n * @param {Binding} x\n * @param {Binding} y\n */\nfunction _isEqualBinding(x, y) {\n  if (typeof x === 'object' && typeof y === 'object') {\n    return x.error === y.error && ReactiveVar._isEqual(x.value, y.value);\n  }\n  else {\n    return ReactiveVar._isEqual(x, y);\n  }\n}\n\n/**\n * Attaches bindings to the instantiated view.\n * @param {Object} bindings A dictionary of bindings, each binding name\n * corresponds to a value or a function that will be reactively re-run.\n * @param {Blaze.View} view The target.\n */\nBlaze._attachBindingsToView = function (bindings, view) {\n  function setBindingValue(name, value) {\n    if (value && typeof value.then === 'function') {\n      value.then(\n        value => view._scopeBindings[name].set({ value }),\n        error => view._scopeBindings[name].set({ error }),\n      );\n    } else {\n      view._scopeBindings[name].set({ value });\n    }\n  }\n\n  view.onViewCreated(function () {\n    Object.entries(bindings).forEach(function ([name, binding]) {\n      view._scopeBindings[name] = new ReactiveVar(undefined, _isEqualBinding);\n      if (typeof binding === 'function') {\n        view.autorun(() => setBindingValue(name, binding()), view.parentView);\n      } else {\n        setBindingValue(name, binding);\n      }\n    });\n  });\n};\n\n/**\n * @summary Constructs a View setting the local lexical scope in the block.\n * @param {Function} bindings Dictionary mapping names of bindings to\n * values or computations to reactively re-run.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n */\nBlaze.Let = function (bindings, contentFunc) {\n  var view = Blaze.View('let', contentFunc);\n  Blaze._attachBindingsToView(bindings, view);\n\n  return view;\n};\n\n/**\n * @summary Constructs a View that renders content conditionally.\n * @locus Client\n * @param {Function} conditionFunc A function to reactively re-run.  Whether the result is truthy or falsy determines\n *   whether `contentFunc` or `elseFunc` is shown.  An empty array is considered falsy.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n * @param {Function} [elseFunc] Optional.  A Function that returns [*renderable content*](#Renderable-Content).  If no\n *   `elseFunc` is supplied, no content is shown in the \"else\" case.\n */\nBlaze.If = function (conditionFunc, contentFunc, elseFunc, _not) {\n  var conditionVar = new ReactiveVar;\n\n  var view = Blaze.View(_not ? 'unless' : 'if', function () {\n    return conditionVar.get() ? contentFunc() :\n      (elseFunc ? elseFunc() : null);\n  });\n  view.__conditionVar = conditionVar;\n  view.onViewCreated(function () {\n    this.autorun(function () {\n      var cond = Blaze._calculateCondition(conditionFunc());\n      conditionVar.set(_not ? (! cond) : cond);\n    }, this.parentView, 'condition');\n  });\n\n  return view;\n};\n\n/**\n * @summary An inverted [`Blaze.If`](#Blaze-If).\n * @locus Client\n * @param {Function} conditionFunc A function to reactively re-run.  If the result is falsy, `contentFunc` is shown,\n *   otherwise `elseFunc` is shown.  An empty array is considered falsy.\n * @param {Function} contentFunc A Function that returns [*renderable content*](#Renderable-Content).\n * @param {Function} [elseFunc] Optional.  A Function that returns [*renderable content*](#Renderable-Content).  If no\n *   `elseFunc` is supplied, no content is shown in the \"else\" case.\n */\nBlaze.Unless = function (conditionFunc, contentFunc, elseFunc) {\n  return Blaze.If(conditionFunc, contentFunc, elseFunc, true /*_not*/);\n};\n\n/**\n * @summary Constructs a View that renders `contentFunc` for each item in a sequence.\n * @locus Client\n * @param {Function} argFunc A function to reactively re-run. The function can\n * return one of two options:\n *\n * 1. An object with two fields: '_variable' and '_sequence'. Each iterates over\n *   '_sequence', it may be a Cursor, an array, null, or undefined. Inside the\n *   Each body you will be able to get the current item from the sequence using\n *   the name specified in the '_variable' field.\n *\n * 2. Just a sequence (Cursor, array, null, or undefined) not wrapped into an\n *   object. Inside the Each body, the current item will be set as the data\n *   context.\n * @param {Function} contentFunc A Function that returns  [*renderable\n * content*](#Renderable-Content).\n * @param {Function} [elseFunc] A Function that returns [*renderable\n * content*](#Renderable-Content) to display in the case when there are no items\n * in the sequence.\n */\nBlaze.Each = function (argFunc, contentFunc, elseFunc) {\n  var eachView = Blaze.View('each', function () {\n    var subviews = this.initialSubviews;\n    this.initialSubviews = null;\n    if (this._isCreatedForExpansion) {\n      this.expandedValueDep = new Tracker.Dependency;\n      this.expandedValueDep.depend();\n    }\n    return subviews;\n  });\n  eachView.initialSubviews = [];\n  eachView.numItems = 0;\n  eachView.inElseMode = false;\n  eachView.stopHandle = null;\n  eachView.contentFunc = contentFunc;\n  eachView.elseFunc = elseFunc;\n  eachView.argVar = new ReactiveVar;\n  eachView.variableName = null;\n\n  // update the @index value in the scope of all subviews in the range\n  var updateIndices = function (from, to) {\n    if (to === undefined) {\n      to = eachView.numItems - 1;\n    }\n\n    for (var i = from; i <= to; i++) {\n      var view = eachView._domrange.members[i].view;\n      view._scopeBindings['@index'].set({ value: i });\n    }\n  };\n\n  eachView.onViewCreated(function () {\n    // We evaluate argFunc in an autorun to make sure\n    // Blaze.currentView is always set when it runs (rather than\n    // passing argFunc straight to ObserveSequence).\n    eachView.autorun(function () {\n      // argFunc can return either a sequence as is or a wrapper object with a\n      // _sequence and _variable fields set.\n      var arg = argFunc();\n      if (isObject(arg) && has(arg, '_sequence')) {\n        eachView.variableName = arg._variable || null;\n        arg = arg._sequence;\n      }\n\n      eachView.argVar.set(arg);\n    }, eachView.parentView, 'collection');\n\n    eachView.stopHandle = ObserveSequence.observe(function () {\n      return eachView.argVar.get();\n    }, {\n      addedAt: function (id, item, index) {\n        Tracker.nonreactive(function () {\n          var newItemView;\n          if (eachView.variableName) {\n            // new-style #each (as in {{#each item in items}})\n            // doesn't create a new data context\n            newItemView = Blaze.View('item', eachView.contentFunc);\n          } else {\n            newItemView = Blaze.With(item, eachView.contentFunc);\n          }\n\n          eachView.numItems++;\n\n          var bindings = {};\n          bindings['@index'] = index;\n          if (eachView.variableName) {\n            bindings[eachView.variableName] = item;\n          }\n          Blaze._attachBindingsToView(bindings, newItemView);\n\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            if (eachView.inElseMode) {\n              eachView._domrange.removeMember(0);\n              eachView.inElseMode = false;\n            }\n\n            var range = Blaze._materializeView(newItemView, eachView);\n            eachView._domrange.addMember(range, index);\n            updateIndices(index);\n          } else {\n            eachView.initialSubviews.splice(index, 0, newItemView);\n          }\n        });\n      },\n      removedAt: function (id, item, index) {\n        Tracker.nonreactive(function () {\n          eachView.numItems--;\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            eachView._domrange.removeMember(index);\n            updateIndices(index);\n            if (eachView.elseFunc && eachView.numItems === 0) {\n              eachView.inElseMode = true;\n              eachView._domrange.addMember(\n                Blaze._materializeView(\n                  Blaze.View('each_else',eachView.elseFunc),\n                  eachView), 0);\n            }\n          } else {\n            eachView.initialSubviews.splice(index, 1);\n          }\n        });\n      },\n      changedAt: function (id, newItem, oldItem, index) {\n        Tracker.nonreactive(function () {\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else {\n            var itemView;\n            if (eachView._domrange) {\n              itemView = eachView._domrange.getMember(index).view;\n            } else {\n              itemView = eachView.initialSubviews[index];\n            }\n            if (eachView.variableName) {\n              itemView._scopeBindings[eachView.variableName].set({ value: newItem });\n            } else {\n              itemView.dataVar.set(newItem);\n            }\n          }\n        });\n      },\n      movedTo: function (id, item, fromIndex, toIndex) {\n        Tracker.nonreactive(function () {\n          if (eachView.expandedValueDep) {\n            eachView.expandedValueDep.changed();\n          } else if (eachView._domrange) {\n            eachView._domrange.moveMember(fromIndex, toIndex);\n            updateIndices(\n              Math.min(fromIndex, toIndex), Math.max(fromIndex, toIndex));\n          } else {\n            var subviews = eachView.initialSubviews;\n            var itemView = subviews[fromIndex];\n            subviews.splice(fromIndex, 1);\n            subviews.splice(toIndex, 0, itemView);\n          }\n        });\n      }\n    });\n\n    if (eachView.elseFunc && eachView.numItems === 0) {\n      eachView.inElseMode = true;\n      eachView.initialSubviews[0] =\n        Blaze.View('each_else', eachView.elseFunc);\n    }\n  });\n\n  eachView.onViewDestroyed(function () {\n    if (eachView.stopHandle)\n      eachView.stopHandle.stop();\n  });\n\n  return eachView;\n};\n\nBlaze._TemplateWith = function (arg, contentFunc) {\n  var w;\n\n  var argFunc = arg;\n  if (typeof arg !== 'function') {\n    argFunc = function () {\n      return arg;\n    };\n  }\n\n  // This is a little messy.  When we compile `{{> Template.contentBlock}}`, we\n  // wrap it in Blaze._InOuterTemplateScope in order to skip the intermediate\n  // parent Views in the current template.  However, when there's an argument\n  // (`{{> Template.contentBlock arg}}`), the argument needs to be evaluated\n  // in the original scope.  There's no good order to nest\n  // Blaze._InOuterTemplateScope and Blaze._TemplateWith to achieve this,\n  // so we wrap argFunc to run it in the \"original parentView\" of the\n  // Blaze._InOuterTemplateScope.\n  //\n  // To make this better, reconsider _InOuterTemplateScope as a primitive.\n  // Longer term, evaluate expressions in the proper lexical scope.\n  var wrappedArgFunc = function () {\n    var viewToEvaluateArg = null;\n    if (w.parentView && w.parentView.name === 'InOuterTemplateScope') {\n      viewToEvaluateArg = w.parentView.originalParentView;\n    }\n    if (viewToEvaluateArg) {\n      return Blaze._withCurrentView(viewToEvaluateArg, argFunc);\n    } else {\n      return argFunc();\n    }\n  };\n\n  var wrappedContentFunc = function () {\n    var content = contentFunc.call(this);\n\n    // Since we are generating the Blaze._TemplateWith view for the\n    // user, set the flag on the child view.  If `content` is a template,\n    // construct the View so that we can set the flag.\n    if (content instanceof Blaze.Template) {\n      content = content.constructView();\n    }\n    if (content instanceof Blaze.View) {\n      content._hasGeneratedParent = true;\n    }\n\n    return content;\n  };\n\n  w = Blaze.With(wrappedArgFunc, wrappedContentFunc);\n  w.__isTemplateWith = true;\n  return w;\n};\n\nBlaze._InOuterTemplateScope = function (templateView, contentFunc) {\n  var view = Blaze.View('InOuterTemplateScope', contentFunc);\n  var parentView = templateView.parentView;\n\n  // Hack so that if you call `{{> foo bar}}` and it expands into\n  // `{{#with bar}}{{> foo}}{{/with}}`, and then `foo` is a template\n  // that inserts `{{> Template.contentBlock}}`, the data context for\n  // `Template.contentBlock` is not `bar` but the one enclosing that.\n  if (parentView.__isTemplateWith)\n    parentView = parentView.parentView;\n\n  view.onViewCreated(function () {\n    this.originalParentView = this.parentView;\n    this.parentView = parentView;\n    this.__childDoesntStartNewLexicalScope = true;\n  });\n  return view;\n};\n\n","import has from 'lodash.has';\n\n/** @param {(binding: Binding) => boolean} fn */\nfunction _createBindingsHelper(fn) {\n  /** @param {string[]} names */\n  return (...names) => {\n    const view = Blaze.currentView;\n\n    // There's either zero arguments (i.e., check all bindings) or an additional\n    // \"hash\" argument that we have to ignore.\n    names = names.length === 0\n      // TODO: Should we walk up the bindings here?\n      ? Object.keys(view._scopeBindings)\n      : names.slice(0, -1);\n\n    return names.some(name => {\n      const binding = _lexicalBindingLookup(view, name);\n      if (!binding) {\n        throw new Error(`Binding for \"${name}\" was not found.`);\n      }\n\n      return fn(binding.get());\n    });\n  };\n}\n\nBlaze._globalHelpers = {\n  /** @summary Check whether any of the given bindings (or all if none given) is still pending. */\n  '@pending': _createBindingsHelper(binding => binding === undefined),\n  /** @summary Check whether any of the given bindings (or all if none given) has rejected. */\n  '@rejected': _createBindingsHelper(binding => !!binding && 'error' in binding),\n  /** @summary Check whether any of the given bindings (or all if none given) has resolved. */\n  '@resolved': _createBindingsHelper(binding => !!binding && 'value' in binding),\n};\n\n// Documented as Template.registerHelper.\n// This definition also provides back-compat for `UI.registerHelper`.\nBlaze.registerHelper = function (name, func) {\n  Blaze._globalHelpers[name] = func;\n};\n\n// Also documented as Template.deregisterHelper\nBlaze.deregisterHelper = function(name) {\n  delete Blaze._globalHelpers[name];\n};\n\nvar bindIfIsFunction = function (x, target) {\n  if (typeof x !== 'function')\n    return x;\n  return Blaze._bind(x, target);\n};\n\n// If `x` is a function, binds the value of `this` for that function\n// to the current data context.\nvar bindDataContext = function (x) {\n  if (typeof x === 'function') {\n    return function () {\n      var data = Blaze.getData();\n      if (data == null)\n        data = {};\n      return x.apply(data, arguments);\n    };\n  }\n  return x;\n};\n\nBlaze._OLDSTYLE_HELPER = {};\n\nBlaze._getTemplateHelper = function (template, name, tmplInstanceFunc) {\n  // XXX COMPAT WITH 0.9.3\n  var isKnownOldStyleHelper = false;\n\n  if (template.__helpers.has(name)) {\n    var helper = template.__helpers.get(name);\n    if (helper === Blaze._OLDSTYLE_HELPER) {\n      isKnownOldStyleHelper = true;\n    } else if (helper != null) {\n      return wrapHelper(bindDataContext(helper), tmplInstanceFunc);\n    } else {\n      return null;\n    }\n  }\n\n  // old-style helper\n  if (name in template) {\n    // Only warn once per helper\n    if (! isKnownOldStyleHelper) {\n      template.__helpers.set(name, Blaze._OLDSTYLE_HELPER);\n      if (! template._NOWARN_OLDSTYLE_HELPERS) {\n        Blaze._warn('Assigning helper with `' + template.viewName + '.' +\n                    name + ' = ...` is deprecated.  Use `' + template.viewName +\n                    '.helpers(...)` instead.');\n      }\n    }\n    if (template[name] != null) {\n      return wrapHelper(bindDataContext(template[name]), tmplInstanceFunc);\n    }\n  }\n\n  return null;\n};\n\nvar wrapHelper = function (f, templateFunc) {\n  if (typeof f !== \"function\") {\n    return f;\n  }\n\n  return function () {\n    var self = this;\n    var args = arguments;\n\n    return Blaze.Template._withTemplateInstanceFunc(templateFunc, function () {\n      return Blaze._wrapCatchingExceptions(f, 'template helper').apply(self, args);\n    });\n  };\n};\n\nfunction _lexicalKeepGoing(currentView) {\n  if (!currentView.parentView) {\n    return undefined;\n  }\n  if (!currentView.__startsNewLexicalScope) {\n    return currentView.parentView;\n  }\n  if (currentView.parentView.__childDoesntStartNewLexicalScope) {\n    return currentView.parentView;\n  }\n  \n  // in the case of {{> Template.contentBlock data}} the contentBlock loses the lexical scope of it's parent, wheras {{> Template.contentBlock}} it does not\n  // this is because a #with sits between the include InOuterTemplateScope\n  if (currentView.parentView.name === \"with\" && currentView.parentView.parentView && currentView.parentView.parentView.__childDoesntStartNewLexicalScope) {\n    return currentView.parentView;\n  }\n  return undefined;\n}\n\nfunction _lexicalBindingLookup(view, name) {\n  var currentView = view;\n\n  // walk up the views stopping at a Spacebars.include or Template view that\n  // doesn't have an InOuterTemplateScope view as a parent\n  do {\n    // skip block helpers views\n    // if we found the binding on the scope, return it\n    if (has(currentView._scopeBindings, name)) {\n      return currentView._scopeBindings[name];\n    }\n  } while (currentView = _lexicalKeepGoing(currentView));\n\n  return null;\n}\n\nBlaze._lexicalBindingLookup = function (view, name) {\n  const binding = _lexicalBindingLookup(view, name);\n  return binding && (() => binding.get()?.value);\n};\n\n// templateInstance argument is provided to be available for possible\n// alternative implementations of this function by 3rd party packages.\nBlaze._getTemplate = function (name, templateInstance) {\n  if ((name in Blaze.Template) && (Blaze.Template[name] instanceof Blaze.Template)) {\n    return Blaze.Template[name];\n  }\n  return null;\n};\n\nBlaze._getGlobalHelper = function (name, templateInstance) {\n  if (Blaze._globalHelpers[name] != null) {\n    return wrapHelper(bindDataContext(Blaze._globalHelpers[name]), templateInstance);\n  }\n  return null;\n};\n\n// Looks up a name, like \"foo\" or \"..\", as a helper of the\n// current template; the name of a template; a global helper;\n// or a property of the data context.  Called on the View of\n// a template (i.e. a View with a `.template` property,\n// where the helpers are).  Used for the first name in a\n// \"path\" in a template tag, like \"foo\" in `{{foo.bar}}` or\n// \"..\" in `{{frobulate ../blah}}`.\n//\n// Returns a function, a non-function value, or null.  If\n// a function is found, it is bound appropriately.\n//\n// NOTE: This function must not establish any reactive\n// dependencies itself.  If there is any reactivity in the\n// value, lookup should return a function.\nBlaze.View.prototype.lookup = function (name, _options) {\n  var template = this.template;\n  var lookupTemplate = _options && _options.template;\n  var helper;\n  var binding;\n  var boundTmplInstance;\n  var foundTemplate;\n\n  if (this.templateInstance) {\n    boundTmplInstance = Blaze._bind(this.templateInstance, this);\n  }\n\n  // 0. looking up the parent data context with the special \"../\" syntax\n  if (/^\\./.test(name)) {\n    // starts with a dot. must be a series of dots which maps to an\n    // ancestor of the appropriate height.\n    if (!/^(\\.)+$/.test(name))\n      throw new Error(\"id starting with dot must be a series of dots\");\n\n    return Blaze._parentData(name.length - 1, true /*_functionWrapped*/);\n\n  }\n\n  // 1. look up a helper on the current template\n  if (template && ((helper = Blaze._getTemplateHelper(template, name, boundTmplInstance)) != null)) {\n    return helper;\n  }\n\n  // 2. look up a binding by traversing the lexical view hierarchy inside the\n  // current template\n  if (template && (binding = Blaze._lexicalBindingLookup(Blaze.currentView, name)) != null) {\n    return binding;\n  }\n\n  // 3. look up a template by name\n  if (lookupTemplate && ((foundTemplate = Blaze._getTemplate(name, boundTmplInstance)) != null)) {\n    return foundTemplate;\n  }\n\n  // 4. look up a global helper\n  if ((helper = Blaze._getGlobalHelper(name, boundTmplInstance)) != null) {\n    return helper;\n  }\n\n  // 5. look up in a data context\n  return function () {\n    var isCalledAsFunction = (arguments.length > 0);\n    var data = Blaze.getData();\n    var x = data && data[name];\n    if (! x) {\n      if (lookupTemplate) {\n        throw new Error(\"No such template: \" + name);\n      } else if (isCalledAsFunction) {\n        throw new Error(\"No such function: \" + name);\n      } else if (name.charAt(0) === '@' && ((x === null) ||\n                                            (x === undefined))) {\n        // Throw an error if the user tries to use a `@directive`\n        // that doesn't exist.  We don't implement all directives\n        // from Handlebars, so there's a potential for confusion\n        // if we fail silently.  On the other hand, we want to\n        // throw late in case some app or package wants to provide\n        // a missing directive.\n        throw new Error(\"Unsupported directive: \" + name);\n      }\n    }\n    if (! data) {\n      return null;\n    }\n    if (typeof x !== 'function') {\n      if (isCalledAsFunction) {\n        throw new Error(\"Can't call non-function: \" + x);\n      }\n      return x;\n    }\n    return x.apply(data, arguments);\n  };\n};\n\n// Implement Spacebars' {{../..}}.\n// @param height {Number} The number of '..'s\nBlaze._parentData = function (height, _functionWrapped) {\n  // If height is null or undefined, we default to 1, the first parent.\n  if (height == null) {\n    height = 1;\n  }\n  var theWith = Blaze.getView('with');\n  for (var i = 0; (i < height) && theWith; i++) {\n    theWith = Blaze.getView(theWith, 'with');\n  }\n\n  if (! theWith)\n    return null;\n  if (_functionWrapped)\n    return function () { return theWith.dataVar.get(); };\n  return theWith.dataVar.get();\n};\n\n\nBlaze.View.prototype.lookupTemplate = function (name) {\n  return this.lookup(name, {template:true});\n};\n","import isObject from 'lodash.isobject';\nimport isFunction from 'lodash.isfunction';\nimport has from 'lodash.has';\nimport isEmpty from 'lodash.isempty';\n\n// [new] Blaze.Template([viewName], renderFunction)\n//\n// `Blaze.Template` is the class of templates, like `Template.foo` in\n// Meteor, which is `instanceof Template`.\n//\n// `viewKind` is a string that looks like \"Template.foo\" for templates\n// defined by the compiler.\n\n/**\n * @class\n * @summary Constructor for a Template, which is used to construct Views with particular name and content.\n * @locus Client\n * @param {String} [viewName] Optional.  A name for Views constructed by this Template.  See [`view.name`](#view_name).\n * @param {Function} renderFunction A function that returns [*renderable content*](#Renderable-Content).  This function is used as the `renderFunction` for Views constructed by this Template.\n */\nBlaze.Template = function (viewName, renderFunction) {\n  if (! (this instanceof Blaze.Template))\n    // called without `new`\n    return new Blaze.Template(viewName, renderFunction);\n\n  if (typeof viewName === 'function') {\n    // omitted \"viewName\" argument\n    renderFunction = viewName;\n    viewName = '';\n  }\n  if (typeof viewName !== 'string')\n    throw new Error(\"viewName must be a String (or omitted)\");\n  if (typeof renderFunction !== 'function')\n    throw new Error(\"renderFunction must be a function\");\n\n  this.viewName = viewName;\n  this.renderFunction = renderFunction;\n\n  this.__helpers = new HelperMap;\n  this.__eventMaps = [];\n\n  this._callbacks = {\n    created: [],\n    rendered: [],\n    destroyed: []\n  };\n};\nvar Template = Blaze.Template;\n\nvar HelperMap = function () {};\nHelperMap.prototype.get = function (name) {\n  return this[' '+name];\n};\nHelperMap.prototype.set = function (name, helper) {\n  this[' '+name] = helper;\n};\nHelperMap.prototype.has = function (name) {\n  return (typeof this[' '+name] !== 'undefined');\n};\n\n/**\n * @summary Returns true if `value` is a template object like `Template.myTemplate`.\n * @locus Client\n * @param {Any} value The value to test.\n */\nBlaze.isTemplate = function (t) {\n  return (t instanceof Blaze.Template);\n};\n\n/**\n * @name  onCreated\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is created.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\nTemplate.prototype.onCreated = function (cb) {\n  this._callbacks.created.push(cb);\n};\n\n/**\n * @name  onRendered\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is inserted into the DOM.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\nTemplate.prototype.onRendered = function (cb) {\n  this._callbacks.rendered.push(cb);\n};\n\n/**\n * @name  onDestroyed\n * @instance\n * @memberOf Template\n * @summary Register a function to be called when an instance of this template is removed from the DOM and destroyed.\n * @param {Function} callback A function to be added as a callback.\n * @locus Client\n * @importFromPackage templating\n */\nTemplate.prototype.onDestroyed = function (cb) {\n  this._callbacks.destroyed.push(cb);\n};\n\nTemplate.prototype._getCallbacks = function (which) {\n  var self = this;\n  var callbacks = self[which] ? [self[which]] : [];\n  // Fire all callbacks added with the new API (Template.onRendered())\n  // as well as the old-style callback (e.g. Template.rendered) for\n  // backwards-compatibility.\n  callbacks = callbacks.concat(self._callbacks[which]);\n  return callbacks;\n};\n\nvar fireCallbacks = function (callbacks, template) {\n  Template._withTemplateInstanceFunc(\n    function () { return template; },\n    function () {\n      for (var i = 0, N = callbacks.length; i < N; i++) {\n        callbacks[i].call(template);\n      }\n    });\n};\n\nTemplate.prototype.constructView = function (contentFunc, elseFunc) {\n  var self = this;\n  var view = Blaze.View(self.viewName, self.renderFunction);\n  view.template = self;\n\n  view.templateContentBlock = (\n    contentFunc ? new Template('(contentBlock)', contentFunc) : null);\n  view.templateElseBlock = (\n    elseFunc ? new Template('(elseBlock)', elseFunc) : null);\n\n  if (self.__eventMaps || typeof self.events === 'object') {\n    view._onViewRendered(function () {\n      if (view.renderCount !== 1)\n        return;\n\n      if (! self.__eventMaps.length && typeof self.events === \"object\") {\n        // Provide limited back-compat support for `.events = {...}`\n        // syntax.  Pass `template.events` to the original `.events(...)`\n        // function.  This code must run only once per template, in\n        // order to not bind the handlers more than once, which is\n        // ensured by the fact that we only do this when `__eventMaps`\n        // is falsy, and we cause it to be set now.\n        Template.prototype.events.call(self, self.events);\n      }\n\n      self.__eventMaps.forEach(function (m) {\n        Blaze._addEventMap(view, m, view);\n      });\n    });\n  }\n\n  view._templateInstance = new Blaze.TemplateInstance(view);\n  view.templateInstance = function () {\n    // Update data, firstNode, and lastNode, and return the TemplateInstance\n    // object.\n    var inst = view._templateInstance;\n\n    /**\n     * @instance\n     * @memberOf Blaze.TemplateInstance\n     * @name  data\n     * @summary The data context of this instance's latest invocation.\n     * @locus Client\n     */\n    inst.data = Blaze.getData(view);\n\n    if (view._domrange && !view.isDestroyed) {\n      inst.firstNode = view._domrange.firstNode();\n      inst.lastNode = view._domrange.lastNode();\n    } else {\n      // on 'created' or 'destroyed' callbacks we don't have a DomRange\n      inst.firstNode = null;\n      inst.lastNode = null;\n    }\n\n    return inst;\n  };\n\n  /**\n   * @name  created\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is created.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n  // To avoid situations when new callbacks are added in between view\n  // instantiation and event being fired, decide on all callbacks to fire\n  // immediately and then fire them on the event.\n  var createdCallbacks = self._getCallbacks('created');\n  view.onViewCreated(function () {\n    fireCallbacks(createdCallbacks, view.templateInstance());\n  });\n\n  /**\n   * @name  rendered\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is rendered.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n  var renderedCallbacks = self._getCallbacks('rendered');\n  view.onViewReady(function () {\n    fireCallbacks(renderedCallbacks, view.templateInstance());\n  });\n\n  /**\n   * @name  destroyed\n   * @instance\n   * @memberOf Template\n   * @summary Provide a callback when an instance of a template is destroyed.\n   * @locus Client\n   * @deprecated in 1.1\n   */\n  var destroyedCallbacks = self._getCallbacks('destroyed');\n  view.onViewDestroyed(function () {\n    fireCallbacks(destroyedCallbacks, view.templateInstance());\n  });\n\n  return view;\n};\n\n/**\n * @class\n * @summary The class for template instances\n * @param {Blaze.View} view\n * @instanceName template\n */\nBlaze.TemplateInstance = function (view) {\n  if (! (this instanceof Blaze.TemplateInstance))\n    // called without `new`\n    return new Blaze.TemplateInstance(view);\n\n  if (! (view instanceof Blaze.View))\n    throw new Error(\"View required\");\n\n  view._templateInstance = this;\n\n  /**\n   * @name view\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The [View](../api/blaze.html#Blaze-View) object for this invocation of the template.\n   * @locus Client\n   * @type {Blaze.View}\n   */\n  this.view = view;\n  this.data = null;\n\n  /**\n   * @name firstNode\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The first top-level DOM node in this template instance.\n   * @locus Client\n   * @type {DOMNode}\n   */\n  this.firstNode = null;\n\n  /**\n   * @name lastNode\n   * @memberOf Blaze.TemplateInstance\n   * @instance\n   * @summary The last top-level DOM node in this template instance.\n   * @locus Client\n   * @type {DOMNode}\n   */\n  this.lastNode = null;\n\n  // This dependency is used to identify state transitions in\n  // _subscriptionHandles which could cause the result of\n  // TemplateInstance#subscriptionsReady to change. Basically this is triggered\n  // whenever a new subscription handle is added or when a subscription handle\n  // is removed and they are not ready.\n  this._allSubsReadyDep = new Tracker.Dependency();\n  this._allSubsReady = false;\n\n  this._subscriptionHandles = {};\n};\n\n/**\n * @summary Find all elements matching `selector` in this template instance, and return them as a JQuery object.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMNode[]}\n */\nBlaze.TemplateInstance.prototype.$ = function (selector) {\n  var view = this.view;\n  if (! view._domrange)\n    throw new Error(\"Can't use $ on template instance with no DOM\");\n  return view._domrange.$(selector);\n};\n\n/**\n * @summary Find all elements matching `selector` in this template instance.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMElement[]}\n */\nBlaze.TemplateInstance.prototype.findAll = function (selector) {\n  return Array.prototype.slice.call(this.$(selector));\n};\n\n/**\n * @summary Find one element matching `selector` in this template instance.\n * @locus Client\n * @param {String} selector The CSS selector to match, scoped to the template contents.\n * @returns {DOMElement}\n */\nBlaze.TemplateInstance.prototype.find = function (selector) {\n  var result = this.$(selector);\n  return result[0] || null;\n};\n\n/**\n * @summary A version of [Tracker.autorun](https://docs.meteor.com/api/tracker.html#Tracker-autorun) that is stopped when the template is destroyed.\n * @locus Client\n * @param {Function} runFunc The function to run. It receives one argument: a Tracker.Computation object.\n */\nBlaze.TemplateInstance.prototype.autorun = function (f) {\n  return this.view.autorun(f);\n};\n\n/**\n * @summary A version of [Meteor.subscribe](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe) that is stopped\n * when the template is destroyed.\n * @return {SubscriptionHandle} The subscription handle to the newly made\n * subscription. Call `handle.stop()` to manually stop the subscription, or\n * `handle.ready()` to find out if this particular subscription has loaded all\n * of its inital data.\n * @locus Client\n * @param {String} name Name of the subscription.  Matches the name of the\n * server's `publish()` call.\n * @param {Any} [arg1,arg2...] Optional arguments passed to publisher function\n * on server.\n * @param {Function|Object} [options] If a function is passed instead of an\n * object, it is interpreted as an `onReady` callback.\n * @param {Function} [options.onReady] Passed to [`Meteor.subscribe`](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe).\n * @param {Function} [options.onStop] Passed to [`Meteor.subscribe`](https://docs.meteor.com/api/pubsub.html#Meteor-subscribe).\n * @param {DDP.Connection} [options.connection] The connection on which to make the\n * subscription.\n */\nBlaze.TemplateInstance.prototype.subscribe = function (...args) {\n  var self = this;\n\n  var subHandles = self._subscriptionHandles;\n\n  // Duplicate logic from Meteor.subscribe\n  var options = {};\n  if (args.length) {\n    var lastParam = args[args.length - 1];\n\n    // Match pattern to check if the last arg is an options argument\n    var lastParamOptionsPattern = {\n      onReady: Match.Optional(Function),\n      // XXX COMPAT WITH 1.0.3.1 onError used to exist, but now we use\n      // onStop with an error callback instead.\n      onError: Match.Optional(Function),\n      onStop: Match.Optional(Function),\n      connection: Match.Optional(Match.Any)\n    };\n\n    if (isFunction(lastParam)) {\n      options.onReady = args.pop();\n    } else if (lastParam && ! isEmpty(lastParam) && Match.test(lastParam, lastParamOptionsPattern)) {\n      options = args.pop();\n    }\n  }\n\n  var subHandle;\n  var oldStopped = options.onStop;\n  options.onStop = function (error) {\n    // When the subscription is stopped, remove it from the set of tracked\n    // subscriptions to avoid this list growing without bound\n    delete subHandles[subHandle.subscriptionId];\n\n    // Removing a subscription can only change the result of subscriptionsReady\n    // if we are not ready (that subscription could be the one blocking us being\n    // ready).\n    if (! self._allSubsReady) {\n      self._allSubsReadyDep.changed();\n    }\n\n    if (oldStopped) {\n      oldStopped(error);\n    }\n  };\n\n  var connection = options.connection;\n  const { onReady, onError, onStop } = options;\n  var callbacks = { onReady, onError, onStop };\n\n  // The callbacks are passed as the last item in the arguments array passed to\n  // View#subscribe\n  args.push(callbacks);\n\n  // View#subscribe takes the connection as one of the options in the last\n  // argument\n  subHandle = self.view.subscribe.call(self.view, args, {\n    connection: connection\n  });\n\n  if (!has(subHandles, subHandle.subscriptionId)) {\n    subHandles[subHandle.subscriptionId] = subHandle;\n\n    // Adding a new subscription will always cause us to transition from ready\n    // to not ready, but if we are already not ready then this can't make us\n    // ready.\n    if (self._allSubsReady) {\n      self._allSubsReadyDep.changed();\n    }\n  }\n\n  return subHandle;\n};\n\n/**\n * @summary A reactive function that returns true when all of the subscriptions\n * called with [this.subscribe](#TemplateInstance-subscribe) are ready.\n * @return {Boolean} True if all subscriptions on this template instance are\n * ready.\n */\nBlaze.TemplateInstance.prototype.subscriptionsReady = function () {\n  this._allSubsReadyDep.depend();\n  this._allSubsReady = Object.values(this._subscriptionHandles).every((handle) => {  \n    return handle.ready();\n  });\n\n  return this._allSubsReady;\n};\n\n/**\n * @summary Specify template helpers available to this template.\n * @locus Client\n * @param {Object} helpers Dictionary of helper functions by name.\n * @importFromPackage templating\n */\nTemplate.prototype.helpers = function (dict) {\n  if (!isObject(dict)) {\n    throw new Error(\"Helpers dictionary has to be an object\");\n  }\n\n  for (var k in dict) this.__helpers.set(k, dict[k]);\n};\n\nvar canUseGetters = (function () {\n  if (Object.defineProperty) {\n    var obj = {};\n    try {\n      Object.defineProperty(obj, \"self\", {\n        get: function () { return obj; }\n      });\n    } catch (e) {\n      return false;\n    }\n    return obj.self === obj;\n  }\n  return false;\n})();\n\nif (canUseGetters) {\n  // Like Blaze.currentView but for the template instance. A function\n  // rather than a value so that not all helpers are implicitly dependent\n  // on the current template instance's `data` property, which would make\n  // them dependent on the data context of the template inclusion.\n  var currentTemplateInstanceFunc = null;\n\n  // If getters are supported, define this property with a getter function\n  // to make it effectively read-only, and to work around this bizarre JSC\n  // bug: https://github.com/meteor/meteor/issues/9926\n  Object.defineProperty(Template, \"_currentTemplateInstanceFunc\", {\n    get: function () {\n      return currentTemplateInstanceFunc;\n    }\n  });\n\n  Template._withTemplateInstanceFunc = function (templateInstanceFunc, func) {\n    if (typeof func !== 'function') {\n      throw new Error(\"Expected function, got: \" + func);\n    }\n    var oldTmplInstanceFunc = currentTemplateInstanceFunc;\n    try {\n      currentTemplateInstanceFunc = templateInstanceFunc;\n      return func();\n    } finally {\n      currentTemplateInstanceFunc = oldTmplInstanceFunc;\n    }\n  };\n} else {\n  // If getters are not supported, just use a normal property.\n  Template._currentTemplateInstanceFunc = null;\n\n  Template._withTemplateInstanceFunc = function (templateInstanceFunc, func) {\n    if (typeof func !== 'function') {\n      throw new Error(\"Expected function, got: \" + func);\n    }\n    var oldTmplInstanceFunc = Template._currentTemplateInstanceFunc;\n    try {\n      Template._currentTemplateInstanceFunc = templateInstanceFunc;\n      return func();\n    } finally {\n      Template._currentTemplateInstanceFunc = oldTmplInstanceFunc;\n    }\n  };\n}\n\n/**\n * @summary Specify event handlers for this template.\n * @locus Client\n * @param {EventMap} eventMap Event handlers to associate with this template.\n * @importFromPackage templating\n */\nTemplate.prototype.events = function (eventMap) {\n  if (!isObject(eventMap)) {\n    throw new Error(\"Event map has to be an object\");\n  }\n\n  var template = this;\n  var eventMap2 = {};\n  for (var k in eventMap) {\n    eventMap2[k] = (function (k, v) {\n      return function (event /*, ...*/) {\n        var view = this; // passed by EventAugmenter\n        var args = Array.prototype.slice.call(arguments);\n        // Exiting the current computation to avoid creating unnecessary\n        // and unexpected reactive dependencies with Templates data\n        // or any other reactive dependencies defined in event handlers\n        return Tracker.nonreactive(function () {\n          var data = Blaze.getData(event.currentTarget);\n          if (data == null) data = {};\n          var tmplInstanceFunc = Blaze._bind(view.templateInstance, view);\n          args.splice(1, 0, tmplInstanceFunc());\n          return Template._withTemplateInstanceFunc(tmplInstanceFunc, function () {\n            return v.apply(data, args);\n          });\n        });\n      };\n    })(k, eventMap[k]);\n  }\n\n  template.__eventMaps.push(eventMap2);\n};\n\n/**\n * @function\n * @name instance\n * @memberOf Template\n * @summary The [template instance](#Template-instances) corresponding to the current template helper, event handler, callback, or autorun.  If there isn't one, `null`.\n * @locus Client\n * @returns {Blaze.TemplateInstance}\n * @importFromPackage templating\n */\nTemplate.instance = function () {\n  return Template._currentTemplateInstanceFunc\n    && Template._currentTemplateInstanceFunc();\n};\n\n// Note: Template.currentData() is documented to take zero arguments,\n// while Blaze.getData takes up to one.\n\n/**\n * @summary\n *\n * - Inside an `onCreated`, `onRendered`, or `onDestroyed` callback, returns\n * the data context of the template.\n * - Inside an event handler, returns the data context of the template on which\n * this event handler was defined.\n * - Inside a helper, returns the data context of the DOM node where the helper\n * was used.\n *\n * Establishes a reactive dependency on the result.\n * @locus Client\n * @function\n * @importFromPackage templating\n */\nTemplate.currentData = Blaze.getData;\n\n/**\n * @summary Accesses other data contexts that enclose the current data context.\n * @locus Client\n * @function\n * @param {Integer} [numLevels] The number of levels beyond the current data context to look. Defaults to 1.\n * @importFromPackage templating\n */\nTemplate.parentData = Blaze._parentData;\n\n/**\n * @summary Defines a [helper function](#Template-helpers) which can be used from all templates.\n * @locus Client\n * @function\n * @param {String} name The name of the helper function you are defining.\n * @param {Function} function The helper function itself.\n * @importFromPackage templating\n */\nTemplate.registerHelper = Blaze.registerHelper;\n\n/**\n * @summary Removes a global [helper function](#Template-helpers).\n * @locus Client\n * @function\n * @param {String} name The name of the helper function you are defining.\n * @importFromPackage templating\n */\nTemplate.deregisterHelper = Blaze.deregisterHelper;\n","UI = Blaze;\n\nBlaze.ReactiveVar = ReactiveVar;\nUI._templateInstance = Blaze.Template.instance;\n\nHandlebars = {};\nHandlebars.registerHelper = Blaze.registerHelper;\n\nHandlebars._escape = Blaze._escape;\n\n// Return these from {{...}} helpers to achieve the same as returning\n// strings from {{{...}}} helpers\nHandlebars.SafeString = function(string) {\n  this.string = string;\n};\nHandlebars.SafeString.prototype.toString = function() {\n  return this.string.toString();\n};\n"]}