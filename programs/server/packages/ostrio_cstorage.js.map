{"version":3,"sources":["meteor://ðŸ’»app/packages/ostrio:cstorage/client-storage.js","meteor://ðŸ’»app/packages/ostrio:cstorage/browser-storage.js","meteor://ðŸ’»app/packages/ostrio:cstorage/cookies-storage.js","meteor://ðŸ’»app/packages/ostrio:cstorage/helpers.js","meteor://ðŸ’»app/packages/ostrio:cstorage/js-storage.js"],"names":["module1","CookiesStorage","require","JSStorage","BrowserStorage","isServer","_process","process","browser","debug","console","warn","apply","arguments","ClientStorage","driverName","data","ttlData","StorageDriver","isSupported","driver","document","cookie","Object","assign","prototype","get","key","hasOwnProperty","Date","now","remove","has","keys","empty","module","exports","call","helpers","TTL_SUFFIX","localStorageDriver","clientStorage","init","window","localStorage","i","length","indexOf","expireAt","parseInt","getItem","removeItem","replace","unescape","set","value","ttl","setItem","escape","val","e","DEFAULT_TTL","cookieString","self","split","forEach","pair","substr","trim","slice","_ttl","result","includes","navigator","cookieEnabled","JSON","stringify","toString","err","parse"],"mappings":"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","file":"/packages/ostrio_cstorage.js","sourcesContent":["'use strict';\n\nvar CookiesStorage = require('./cookies-storage.js');\nvar JSStorage = require('./js-storage.js');\nvar BrowserStorage = require('./browser-storage.js');\n\nvar isServer = function () {\n  return typeof process === 'object' && !process?.browser;\n};\n\nvar debug = function () {\n  console.warn.apply(console, arguments);\n};\n\n/**\n * @locus Client\n * @class ClientStorage\n * @param driverName {Sting} - Preferable driver `localStorage` or `cookies`\n * @summary Implement boilerplate Client storage functions, localStorage with fall-back to CookiesStorage\n */\nfunction ClientStorage(driverName) {\n  this.data = {};\n  this.ttlData = {};\n  var StorageDriver;\n  this.driverName = driverName;\n\n  if (isServer()) {\n    StorageDriver = JSStorage;\n    this.driverName = 'js';\n  } else {\n    switch (driverName) {\n    case 'localStorage':\n      if (BrowserStorage.isSupported()) {\n        StorageDriver = BrowserStorage;\n      } else {\n        debug('ClientStorage is set to \"localStorage\", but it is not supported on this browser');\n      }\n      break;\n    case 'cookies':\n      if (CookiesStorage.isSupported()) {\n        StorageDriver = CookiesStorage;\n      } else {\n        debug('ClientStorage is set to \"cookies\", but CookiesStorage is disabled on this browser');\n      }\n      break;\n    case 'js':\n      StorageDriver = JSStorage;\n      this.driverName = 'js';\n      break;\n    default:\n      break;\n    }\n  }\n\n  if (!StorageDriver) {\n    if (BrowserStorage.isSupported()) {\n      this.driverName = 'localStorage';\n      StorageDriver = BrowserStorage;\n    } else if (CookiesStorage.isSupported()) {\n      this.driverName = 'cookies';\n      StorageDriver = CookiesStorage;\n    } else {\n      this.driverName = 'js';\n      StorageDriver = JSStorage;\n    }\n  }\n\n  if (this.driverName === 'cookies') {\n    this.driver = new StorageDriver(this, document.cookie);\n  } else {\n    this.driver = new StorageDriver(this);\n  }\n  Object.assign(this, StorageDriver.prototype);\n}\n\n/**\n * @locus Client\n * @memberOf ClientStorage\n * @name get\n * @param {String} key - The key of the value to read\n * @summary Read a stored value by key. If the key doesn't exist a void 0 (undefined) value will be returned.\n * @returns {String|Mix|void 0}\n */\nClientStorage.prototype.get = function (key) {\n  if (typeof key !== 'string') {\n    return void 0;\n  }\n\n  if (this.data.hasOwnProperty(key)) {\n    if (this.ttlData[key] <= Date.now()) {\n      this.remove(key);\n      return void 0;\n    }\n    return this.data[key];\n  }\n\n  return void 0;\n};\n\n/**\n * @locus Client\n * @memberOf ClientStorage\n * @name has\n * @param {String} key - The name of the record to check\n * @summary Check whether a record key is exists\n * @returns {Boolean}\n */\nClientStorage.prototype.has = function (key) {\n  if (typeof key !== 'string') {\n    return false;\n  }\n\n  if (this.data.hasOwnProperty(key)) {\n    if (this.ttlData[key] <= Date.now()) {\n      this.remove(key);\n      return false;\n    }\n    return true;\n  }\n  return false;\n};\n\n/**\n * @locus Client\n * @memberOf ClientStorage\n * @name keys\n * @summary Returns an array of Strings with all readable keys.\n * @returns {[String]}\n */\nClientStorage.prototype.keys = function () {\n  return Object.keys(this.data);\n};\n\n/**\n * @function\n * @memberOf ClientStorage\n * @name empty\n * @summary Empty storage (remove all key/value pairs)\n * @returns {Boolean}\n */\nClientStorage.prototype.empty = function () {\n  return this.remove();\n};\n\nmodule.exports.JSStorage = JSStorage;\nmodule.exports.BrowserStorage = BrowserStorage;\nmodule.exports.CookiesStorage = CookiesStorage;\n\nmodule.exports.ClientStorage = ClientStorage;\n","var helpers = require('./helpers.js');\nvar TTL_SUFFIX = '.___exp';\nvar localStorageDriver;\n\n/**\n * @locus Client\n * @class BrowserStorage\n * @summary localStorage driven storage\n */\nfunction BrowserStorage(clientStorage) {\n  if (clientStorage) {\n    this.data = clientStorage.data;\n    this.ttlData = clientStorage.ttlData;\n  } else {\n    this.data = {};\n    this.ttlData = {};\n  }\n  this.init();\n}\n\n/**\n * @locus Client\n * @memberOf BrowserStorage\n * @name init\n * @summary parse document.cookie string\n * @returns {void 0}\n */\nBrowserStorage.prototype.init = function () {\n  localStorageDriver = window.localStorage || localStorage;\n\n  // CLEAN UP EXPIRED ITEMS\n  var i = localStorageDriver.length;\n  var key;\n  while (i--) {\n    key = localStorageDriver.key(i);\n    if (typeof key === 'string' && !!~key.indexOf(TTL_SUFFIX)) {\n      var expireAt = parseInt(localStorageDriver.getItem(key));\n      if (expireAt <= Date.now()) {\n        localStorageDriver.removeItem(key);\n        localStorageDriver.removeItem(key.replace(TTL_SUFFIX, ''));\n      } else {\n        this.ttlData[key] = expireAt;\n      }\n    } else {\n      this.data[key] = this.unescape(localStorageDriver.getItem(key));\n    }\n  }\n};\n\n/**\n * @locus Client\n * @memberOf BrowserStorage\n * @name set\n * @param {String} key   - The name of the cookie to create/overwrite\n * @param {String} value - The value of the cookie\n * @param {Number} ttl   - BrowserStorage TTL (e.g. max-age) in seconds\n * @summary Create/overwrite a cookie.\n * @returns {Boolean}\n */\nBrowserStorage.prototype.set = function (key, value, ttl) {\n  if (typeof key === 'string') {\n    this.data[key] = value;\n    localStorageDriver.setItem(key, this.escape(value));\n\n    if (typeof ttl === 'number') {\n      var expireAt = Date.now() + (ttl * 1000);\n      this.ttlData[key] = expireAt;\n      localStorageDriver.setItem(key + TTL_SUFFIX, expireAt);\n    }\n    return true;\n  }\n  return false;\n};\n\n/**\n * @locus Client\n * @memberOf BrowserStorage\n * @name remove\n * @param {String} key - The name of the record to remove\n * @summary Remove a record(s).\n * @returns {Boolean}\n */\nBrowserStorage.prototype.remove = function (key) {\n  if (typeof key === 'string' && this.data.hasOwnProperty(key)) {\n    localStorageDriver.removeItem(key);\n    localStorageDriver.removeItem(key + TTL_SUFFIX);\n    delete this.data[key];\n    delete this.ttlData[key];\n    return true;\n  }\n\n  if (key === void 0) {\n    var keys = this.keys();\n    if (keys.length > 0 && keys[0] !== '') {\n      for (var i = 0; i < keys.length; i++) {\n        this.remove(keys[i]);\n      }\n      return true;\n    }\n  }\n\n  return false;\n};\n\n/**\n * @locus Client\n * @memberOf BrowserStorage\n * @name escape\n * @param {mix} val - The value to escape\n * @summary Escape and stringify the value\n * @returns {String}\n */\nBrowserStorage.prototype.escape = function (val) {\n  return escape(helpers.escape(val));\n};\n\n/**\n * @locus Client\n * @memberOf BrowserStorage\n * @name unescape\n * @param {String} val - The string to unescape\n * @summary Escape and restore original data-type of the value\n * @returns {mix}\n */\nBrowserStorage.prototype.unescape = function (val) {\n  return helpers.unescape(unescape(val));\n};\n\n/**\n * @locus Client\n * @memberOf BrowserStorage\n * @name isSupported\n * @summary Returns `true` is this storage driver is supported\n * @returns {Boolean}\n */\nBrowserStorage.isSupported = function () {\n  try {\n    if ('localStorage' in window && window.localStorage !== null) {\n      // Safari will throw an exception in Private mode\n      window.localStorage.setItem('___test___', 'test');\n      window.localStorage.removeItem('___test___');\n      return true;\n    }\n    return false;\n  } catch (e) {\n    return false;\n  }\n};\n\nmodule.exports = BrowserStorage;\n","var helpers = require('./helpers.js');\nvar DEFAULT_TTL = 3.154e+8; // 10 years\nvar TTL_SUFFIX = '.___exp';\n\n/**\n * @locus Client\n * @class CookiesStorage\n * @param cookieString {String} - Current cookies as String\n * @summary Cookie-driven storage\n */\nfunction CookiesStorage(clientStorage, cookieString) {\n  if (clientStorage) {\n    this.data = clientStorage.data;\n    this.ttlData = clientStorage.ttlData;\n  } else {\n    this.data = {};\n    this.ttlData = {};\n  }\n\n  if (cookieString && typeof cookieString === 'string') {\n    this.init(cookieString);\n  }\n}\n\n/**\n * @locus Client\n * @memberOf CookiesStorage\n * @name init\n * @param cookieString {String} - Current cookies as String\n * @summary parse document.cookie string\n * @returns {void 0}\n */\nCookiesStorage.prototype.init = function (cookieString) {\n  if (typeof cookieString === 'string' && cookieString.length) {\n    var self = this;\n    var i;\n    var key;\n    var val;\n\n    cookieString.split(/; */).forEach(function (pair) {\n      i = pair.indexOf('=');\n      if (i < 0) {\n        return;\n      }\n\n      key = this.unescape(pair.substr(0, i).trim());\n      val = pair.substr(++i, pair.length).trim();\n\n      if (val[0] === '\"') {\n        val = val.slice(1, -1);\n      }\n\n      if (self.data[key] === void 0) {\n        if (typeof key === 'string' && !!~key.indexOf(TTL_SUFFIX)) {\n          self.ttlData[key] = parseInt(val);\n        } else {\n          try {\n            self.data[key] = this.unescape(val);\n          } catch (e) {\n            self.data[key] = val;\n          }\n        }\n      }\n    });\n  }\n};\n\n/**\n * @locus Client\n * @memberOf CookiesStorage\n * @name set\n * @param {String} key   - The name of the cookie to create/overwrite\n * @param {String} value - The value of the cookie\n * @param {Number} ttl   - CookiesStorage TTL (e.g. max-age) in seconds\n * @summary Create/overwrite a cookie.\n * @returns {Boolean}\n */\nCookiesStorage.prototype.set = function (key, value, _ttl) {\n  var ttl = _ttl;\n  if (!ttl || typeof ttl !== 'number') {\n    ttl = DEFAULT_TTL;\n  }\n\n  if (typeof key === 'string') {\n    document.cookie = this.escape(key) + '=' + this.escape(value) + '; Max-Age=' + ttl + '; Path=/';\n    this.data[key] = value;\n    this.ttlData[key] = Date.now() + (ttl * 1000);\n    document.cookie = this.escape(key) + TTL_SUFFIX + '=' + this.ttlData[key] + '; Max-Age=' + ttl + '; Path=/';\n    return true;\n  }\n  return false;\n};\n\n/**\n * @locus Client\n * @memberOf CookiesStorage\n * @name remove\n * @param {String} key - The name of the cookie to remove\n * @summary Remove a cookie(s).\n * @returns {Boolean}\n */\nCookiesStorage.prototype.remove = function (key) {\n  if (typeof key === 'string' && this.data.hasOwnProperty(key)) {\n    delete this.data[key];\n    delete this.ttlData[key];\n    document.cookie = this.escape(key) + '=; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Path=/';\n    document.cookie = this.escape(key) + TTL_SUFFIX + '=; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Path=/';\n    return true;\n  }\n\n  if (key === void 0) {\n    var keys = Object.keys(this.data);\n    if (keys.length > 0 && keys[0] !== '') {\n      for (var i = 0; i < keys.length; i++) {\n        this.remove(keys[i]);\n      }\n      return true;\n    }\n  }\n  return false;\n};\n\n/**\n * @locus Client\n * @memberOf CookiesStorage\n * @name escape\n * @param {mix} val - The value to escape\n * @summary Escape and stringify the value\n * @returns {String}\n */\nCookiesStorage.prototype.escape = function (val) {\n  return escape(helpers.escape(val));\n};\n\n/**\n * @locus Client\n * @memberOf CookiesStorage\n * @name unescape\n * @param {String} val - The string to unescape\n * @summary Escape and restore original data-type of the value\n * @returns {mix}\n */\nCookiesStorage.prototype.unescape = function (val) {\n  return helpers.unescape(unescape(val));\n};\n\n/**\n * @locus Client\n * @memberOf CookiesStorage\n * @name isSupported\n * @summary Returns `true` is this storage driver is supported\n * @returns {Boolean}\n */\nCookiesStorage.isSupported = function () {\n  var result;\n  try {\n    document.cookie = '___isSupported___=value; Max-Age=' + DEFAULT_TTL + '; Path=/';\n    result = document.cookie.includes('___isSupported___');\n    document.cookie = '___isSupported___=; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Path=/';\n  } catch (e) {\n    return false;\n  }\n  return result && navigator.cookieEnabled;\n};\n\nmodule.exports = CookiesStorage;\n","/*\n * @Object\n * @name helpers\n */\nvar helpers = {\n  escape: function (value) {\n    try {\n      return JSON.stringify(value);\n    } catch (e) {\n      try {\n        return value.toString();\n      } catch (err) {\n        return value;\n      }\n    }\n  },\n  unescape: function (value) {\n    try {\n      return JSON.parse(value);\n    } catch (e) {\n      return value;\n    }\n  }\n};\n\nmodule.exports = helpers;\n","/**\n * @locus Client\n * @class JSStorage\n * @summary JavaScript Object-driven storage\n */\nfunction JSStorage(clientStorage) {\n  if (clientStorage) {\n    this.data = clientStorage.data;\n    this.ttlData = clientStorage.ttlData;\n  } else {\n    this.data = {};\n    this.ttlData = {};\n  }\n}\n\n/**\n * @locus Client\n * @memberOf JSStorage\n * @name set\n * @param {String} key   - The key to create/overwrite\n * @param {String} value - The value\n * @param {Number} ttl   - TTL (e.g. max-age) in seconds\n * @summary Create/overwrite a record.\n * @returns {Boolean}\n */\nJSStorage.prototype.set = function (key, value, ttl) {\n  if (typeof key === 'string') {\n    this.data[key] = value;\n    if (typeof ttl === 'number') {\n      this.ttlData[key] = Date.now() + (ttl * 1000);\n    }\n    return true;\n  }\n  return false;\n};\n\n/**\n * @locus Client\n * @memberOf JSStorage\n * @name remove\n * @param {String} key - The key of the record to remove\n * @summary Remove record(s).\n * @returns {Boolean}\n */\nJSStorage.prototype.remove = function (key) {\n  if (typeof key === 'string' && this.data.hasOwnProperty(key)) {\n    delete this.data[key];\n    delete this.ttlData[key];\n    return true;\n  }\n\n  if (key === void 0 && Object.keys(this.data).length) {\n    this.data = {};\n    this.ttlData = {};\n    return true;\n  }\n  return false;\n};\n\n/**\n * @locus Client\n * @memberOf JSStorage\n * @name isSupported\n * @summary Returns `true` is this storage driver is supported\n * @returns {Boolean}\n */\nJSStorage.isSupported = function () {\n  return true;\n};\n\nmodule.exports = JSStorage;\n"]}